<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cyprus Weather</title>
  <meta name="description" content="Forecast and weather for Cyprus." />
  <link rel="icon" href="icons/cyprusweatherinfo.png" type="image/png" />
  <link rel="apple-touch-icon" href="icons/cyprusweatherinfo.png" />
  <link rel="canonical" href="https://cyprusweather.info/" />
  <meta name="robots" content="index,follow" />
  <meta property="og:title" content="Cyprus Weather" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://cyprusweather.info/" />
  <meta property="og:site_name" content="CyprusWeather.info" />
  <meta property="og:locale" content="el_CY" />
  <meta name="twitter:card" content="summary_large_image" />
  <style>
    :root { --bg:#0a2342; --surface:#151719; --muted:#9aa1a9; --text:#e5e7eb; --primary:#9ca3af; --primary-2:#6b7280; --card:#1b1d1f; --chip:#232527; --shadow:0 10px 30px rgba(0,0,0,.25); --radius:18px; }
    @media (prefers-color-scheme: light){ :root{ --bg:#e0e7ef; --surface:#ffffff; --card:#ffffff; --text:#111827; --muted:#6b7280; --chip:#f3f4f6; --shadow:0 6px 20px rgba(2,6,23,.08);} }
    *{box-sizing:border-box} html,body{height:100%}
    body{ margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background:linear-gradient(180deg,var(--bg),#0f1113 40%); color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    header{ border-bottom:1px solid rgba(148,163,184,.15); }
    .wrap{ max-width:960px; margin:0 auto; padding:16px; }
    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{ width:40px; height:40px; border-radius:12px; display:grid; place-items:center; background: radial-gradient(120% 120% at 20% 20%, var(--primary), var(--primary-2)); color:#fff; font-weight:800; letter-spacing:.5px; box-shadow:var(--shadow); overflow:hidden }
    .logo img{ width:100%; height:100%; object-fit:cover }
    .title{ font-size:20px; font-weight:800; } .subtitle{ color:var(--muted); font-size:13px }

    main{ padding:16px 0 48px }
    .grid{ display:grid; gap:16px; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); padding-bottom:0 }
    .card{ background:var(--card); border:1px solid rgba(148,163,184,.15); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px; display:grid; grid-template-columns:88px 1fr; gap:14px; align-items:center; transition:transform .2s ease, box-shadow .2s ease }
    .card:hover{ transform:translateY(-2px); box-shadow:0 12px 32px rgba(0,0,0,.3) }

    .logo-badge{ width:72px; height:72px; border-radius:16px; display:grid; place-items:center; overflow:hidden; background:#ffffff; border:1px solid rgba(148,163,184,.25) }
    .logo-badge img{ width:100%; height:100%; object-fit:contain; padding:8px }
    .provider h3{ margin:0; font-size:18px }
    .provider .desc{ margin-top:6px; font-size:13px; color:var(--muted) }
    .links{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px }
    .badge{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; border:1px solid rgba(148,163,184,.25); background:var(--chip); font-size:12px; color:var(--text); text-decoration:none; transition: border-color .2s ease, background-color .2s ease }
    .badge svg{ width:16px; height:16px }
    .badge:hover{ border-color:rgba(148,163,184,.45) }
    .badge:focus-visible{ outline:3px solid var(--primary); outline-offset:2px }

    .section-title{ margin:16px 0 8px; font-weight:800; font-size:16px }
    #alerts{ margin:8px 0 16px; }
    .alert{ background:#2b1d1d; border:1px solid rgba(220,38,38,.35); color:#fecaca; padding:12px; border-radius:12px; box-shadow:var(--shadow); }
    .forecast-row{ display:grid; gap:16px; grid-template-columns:repeat(3,1fr); padding-bottom:0 }
    .city{ background:var(--card); border:1px solid rgba(148,163,184,.15); border-radius:16px; padding:14px; box-shadow:var(--shadow) }
    .city-header{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:6px }
    .city h4{ margin:0; font-size:15px }
    .current{ display:flex; align-items:baseline; gap:8px }
    .current .t{ font-size:22px; font-weight:800 }
    .current .cond{ color:var(--muted); font-size:12px }
    .metrics{ display:flex; gap:10px; margin:6px 0 10px }
    .metric{ background:var(--chip); border:1px solid rgba(148,163,184,.2); border-radius:10px; padding:6px 8px; font-size:12px }
    .mini-days{ display:grid; grid-template-columns:1fr; gap:6px }
    .mini-day{ display:flex; align-items:center; justify-content:space-between; gap:8px; font-size:12px; padding:6px 0; border-top:1px dashed rgba(148,163,184,.2) }
    .mini-day:first-child{ border-top:none }
    .mini-day .left{ display:flex; align-items:center; gap:8px }
    .mini-day .w{ width:18px; height:18px }
    .muted{ color:var(--muted); font-size:12px }
    .search{ display:flex; gap:8px; margin:8px 0 12px }
    .input{ flex:1; padding:8px 10px; border-radius:10px; border:1px solid rgba(148,163,184,.25); background:var(--chip); color:var(--text) }
    .input::placeholder{ color:var(--muted) }
    .btn{ padding:8px 12px; border-radius:10px; border:1px solid rgba(148,163,184,.25); background:var(--chip); color:var(--text); cursor:pointer }
    .btn:hover{ border-color:rgba(148,163,184,.45) }

    .divider{ height:12px }
    footer{ border-top:1px solid rgba(148,163,184,.15); margin-top:28px }
    .foot{ display:grid; gap:8px; padding:18px 0; color:var(--muted); font-size:12px }
    visit-wrap{ color:var(--text); font-weight:600 }
    body { font-family: sans-serif; text-align: center; }
    #controls { margin: 1em 0; }
    button {
      margin: 0.2em;
      padding: 0.4em 0.8em;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #f0f0f0;
      cursor: pointer;
    }
    button:hover {
      background: #ddd;
    }
    iframe {
      width: 100%;
      height: 500px;
      border: none;
    }
  </style>
</head>
<body>

<script>
  const baseUrl = "https://embed.windy.com/embed.html"
    + "?type=map&location=coordinates&zoom=8"
    + "&product=ecmwf&level=surface"
    + "&lat=34.906&lon=33.25&message=true";

  function setOverlay(overlay) {
    const frame = document.getElementById("windyFrame");
    frame.src = baseUrl + "&overlay=" + overlay;
  }
</script>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand">
        <div class="logo" aria-hidden="true"><img src="icons/cyprusweatherinfo.png" alt="CyprusWeather.info logo" loading="lazy" decoding="async" width="40" height="40" /></div>
        <div>
          <div class="title">Cyprus Weather</div>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div id="grid" class="grid" role="list"></div>
    <div class="divider" role="separator" aria-hidden="true"></div>
    <section id="alerts" aria-live="polite"></section>
    <section id="forecast">
      <form id="search" class="search" role="search" aria-label="Search Cyprus locations">
        <input id="q" class="input" type="search" placeholder="Search municipality/village" />
        <button class="btn" type="submit">Search</button>
      </form>
      <div id="forecast-row" class="forecast-row" role="list"></div>
    </section><p>

<div id="controls">
  <button onclick="setOverlay('wind')">Wind</button>
  <button onclick="setOverlay('gust')">Gusts</button>
  <button onclick="setOverlay('temp')">Temperature</button>
  <button onclick="setOverlay('rain')">Rain</button>
  <button onclick="setOverlay('thunder')">Thunder</button>
  <button onclick="setOverlay('clouds')">Clouds</button>
  <button onclick="setOverlay('dewpoint')">Dewpoint</button>
  <button onclick="setOverlay('rh')">Humidity</button>
  <button onclick="setOverlay('soilMoisture40')">Soil Moisture</button>
  <button onclick="setOverlay('drought40')">Drought</button>
  <button onclick="setOverlay('waves')">Waves</button>
  <button onclick="setOverlay('swell1')">Swell 1</button>
  <button onclick="setOverlay('swell2')">Swell 2</button>
  <button onclick="setOverlay('swell3')">Swell 3</button>
  <button onclick="setOverlay('pressure')">Pressure</button>
  <button onclick="setOverlay('visibility')">Visibility</button>
  <button onclick="setOverlay('capAlerts')">CAP Alerts</button>
</div>

<iframe id="windyFrame"
  src="https://embed.windy.com/embed.html?type=map&location=coordinates&zoom=8&overlay=wind&product=ecmwf&level=surface&lat=34.906&lon=33.25&message=true">
</iframe>
    <footer>
      <div class="foot wrap">
        <div>© <span id="year"></span> CyprusWeather.info</div>
        <div id="visit-wrap">Επισκέψεις: <span id="visits">—</span></div>
      </div>
    </footer>
  </main>

  <script>

    // ---- Forecast & Alerts -------------------------------------------------
    (async function(){
      const cities = [
        { id:'nicosia', name:'Λευκωσία', lat:35.1738, lon:33.3642 },
        { id:'limassol', name:'Λεμεσός', lat:34.6781, lon:33.0416 },
        { id:'larnaca', name:'Λάρνακα', lat:34.9229, lon:33.6290 },
        { id:'paphos', name:'Πάφος', lat:34.7750, lon:32.4297 },
        { id:'ayianapa', name:'Αγία Νάπα', lat:34.9800, lon:34.0010 },
        { id:'troodos', name:'Τρόοδος', lat:34.9167, lon:32.8333 }
      ];
      const forecastEl = document.getElementById('forecast-row');
      const alertsEl = document.getElementById('alerts');

      const WMO = {
        0:['Αίθριος','M0'],1:['Κυρίως αίθριος','M1'],2:['Μερική νέφωση','M2'],3:['Συννεφιά','M3'],
        45:['Ομίχλη','M4'],48:['Παγετός','M5'],51:['Ψιλή βροχή','M6'],53:['Ψιλή βροχή','M6'],55:['Ψιλή βροχή','M6'],
        56:['Παγωμένη ψιλή βροχή','M7'],57:['Παγωμένη ψιλή βροχή','M7'],61:['Βροχή','M8'],63:['Βροχή','M8'],65:['Ισχυρή βροχή','M9'],
        66:['Παγωμένη βροχή','M10'],67:['Παγωμένη βροχή','M10'],71:['Χιονόπτωση','M11'],73:['Χιονόπτωση','M11'],75:['Ισχυρή χιονόπτωση','M12'],
        77:['Νιφάδες','M13'],80:['Μπόρες','M14'],81:['Μπόρες','M14'],82:['Ισχυρές μπόρες','M15'],95:['Καταιγίδα','M16'],96:['Καταιγίδα','M16'],99:['Χαλαζόπτωση','M17']
      };
      function degToCompass(deg){ const dirs=['Β','ΒΒΑ','ΒΑ','ΑΒΑ','Α','ΑΝΑ','ΑΝ','ΑΝΔ','Ν','ΝΝΔ','ΝΔ','ΔΝΔ','Δ','ΔΒΔ','ΔΒ','ΒΔΒ']; return dirs[Math.round(deg/22.5)%16] }
      function codeLabel(code){ return (WMO[code]||['—'])[0] }
      function iconSvg(code){
        // Minimal inline icons by category
        const cloudy = '<svg class="w" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h11a4 4 0 0 0 0-8 6 6 0 0 0-11.3-2.5A4.5 4.5 0 0 0 6 19Z"/></svg>';
        const sun = '<svg class="w" viewBox="0 0 24 24" fill="currentColor"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Zm0-14V2m0 20v-2M4 12H2m20 0h-2M5.64 5.64 4.22 4.22m15.56 15.56-1.42-1.42m0-14.14 1.42-1.42M4.22 19.78l1.42-1.42" stroke="currentColor" stroke-width="2" fill="none"/></svg>';
        const rain = '<svg class="w" viewBox="0 0 24 24" fill="currentColor"><path d="M6 18h11a4 4 0 0 0 0-8 6 6 0 0 0-11.3-2.5A4.5 4.5 0 0 0 6 18Z"/><path d="M8 20l-1 2m4-2-1 2m4-2-1 2" stroke="currentColor" stroke-width="2"/></svg>';
        const storm = '<svg class="w" viewBox="0 0 24 24" fill="currentColor"><path d="M6 17h11a4 4 0 0 0 0-8 6 6 0 0 0-11.3-2.5A4.5 4.5 0 0 0 6 17Z"/><path d="M11 22l2-4h-3l2-4"/></svg>';
        const snow = '<svg class="w" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v18M4.9 7.1l14.2 9.8M4.9 16.9l14.2-9.8" stroke="currentColor" stroke-width="2"/></svg>';
        if([0,1].includes(code)) return sun; if([2,3,45,48].includes(code)) return cloudy; if([61,63,65,80,81,82,51,53,55,56,57].includes(code)) return rain; if([95,96,99].includes(code)) return storm; if([71,73,75,77].includes(code)) return snow; return cloudy;
      }
      function fmtDay(iso){ const d=new Date(iso+'T12:00:00'); return d.toLocaleDateString('el-CY',{weekday:'short', day:'2-digit'}) }

      async function fetchCity(city){
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,wind_direction_10m,weathercode&daily=weathercode,temperature_2m_max,temperature_2m_min,precipitation_probability_max,windspeed_10m_max,winddirection_10m_dominant&timezone=auto&forecast_days=5`;
        const r=await fetch(url); if(!r.ok) throw new Error('forecast'); return r.json();
      }
      function renderCity(city, data){
        const c=document.createElement('div'); c.className='city'; c.role='listitem';
        // header
        const head=document.createElement('div'); head.className='city-header';
        const name=document.createElement('h4'); name.textContent=city.name; head.appendChild(name);
        const cur=document.createElement('div'); cur.className='current';
        cur.innerHTML = `<span class="t">${Math.round(data.current.temperature_2m)}°C</span><span class="cond">${codeLabel(data.current.weathercode)}</span>`;
        head.appendChild(cur); c.appendChild(head);
        // metrics
        const m=document.createElement('div'); m.className='metrics';
        m.innerHTML = `<div class="metric">Άνεμος: ${Math.round(data.current.wind_speed_10m)} km/h ${degToCompass(data.current.wind_direction_10m)}</div><div class="metric">Υγρασία: ${Math.round(data.current.relative_humidity_2m)}%</div>`;
        c.appendChild(m);
        // 5-day mini
        const days=document.createElement('div'); days.className='mini-days';
        for(let i=0;i<data.daily.time.length;i++){
          const row=document.createElement('div'); row.className='mini-day';
          const left=document.createElement('div'); left.className='left';
          const icon=document.createElement('div'); icon.innerHTML=iconSvg(data.daily.weathercode[i]); left.appendChild(icon);
          const when=document.createElement('div'); when.textContent=fmtDay(data.daily.time[i]); left.appendChild(when);
          row.appendChild(left);
          const right=document.createElement('div'); right.className='right'; right.innerHTML = `<strong>${Math.round(data.daily.temperature_2m_max[i])}°/${Math.round(data.daily.temperature_2m_min[i])}°C</strong> <span class="muted">· ${data.daily.precipitation_probability_max[i]??0}% βροχή · ${Math.round(data.daily.windspeed_10m_max[i])} km/h</span>`; row.appendChild(right);
          days.appendChild(row);
        }
        c.appendChild(days);
        forecastEl.appendChild(c);
      }

      try{
        const results = await Promise.allSettled(cities.map(c=> fetchCity(c)));
        results.forEach((r,idx)=>{ if(r.status==='fulfilled'){ renderCity(cities[idx], r.value); } });
      }catch{}

      // MET alerts for Cyprus
      try{
        const ares = await fetch('https://api.met.no/weatherapi/metalerts/2.0/all.json?country=CY');
        if(ares.ok){
          const aj = await ares.json();
          const active = (aj.features||[]).filter(f=> f && f.properties && f.properties.status==='Actual');
          if(active.length){
            const div=document.createElement('div'); div.className='alert';
            const p=active[0].properties; const t=p.event || 'Προειδοποίηση καιρού';
            const lvl=p.severity?` (${p.severity})`:''; const desc=p.description||'';
            div.textContent = `${t}${lvl}: ${desc}`;
            alertsEl.appendChild(div);
          }
        }
      }catch{}

      // Search Cyprus locations (Open-Meteo geocoding) and render card
      const form=document.getElementById('search');
      const q=document.getElementById('q');
      async function geocode(query){
        const url = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(query)}&language=el&count=1&format=json&country=CY`;
        const r=await fetch(url); if(!r.ok) throw new Error('geocode'); return r.json();
      }
      form.addEventListener('submit', async (e)=>{
        e.preventDefault(); const query=(q.value||'').trim(); if(!query) return;
        try{
          const g=await geocode(query);
          const r=g && g.results && g.results[0];
          if(r){
            const city={ id:`s-${r.id}`, name:`${r.name}${r.admin1?`, ${r.admin1}`:''}`, lat:r.latitude, lon:r.longitude };
            const data=await fetchCity(city);
            // Prepend searched result to appear first
            const temp=document.createElement('div');
            renderCity(city, data);
            const row=document.getElementById('forecast-row');
            const last=row.lastElementChild; if(last){ row.insertBefore(last, row.firstChild); }
          }
        }catch{}
      });
    })();

    // ---- Simple visit counter --------------------------------------------
  document.addEventListener('DOMContentLoaded', () => {
    const el = document.getElementById('visits');
    if (!el) return;

    const namespace = 'cyprusweather.info';
    const key = location.hostname || 'local';
    const locale = 'el-CY';

    const endpoints = [
      `https://api.countapi.xyz/hit/${encodeURIComponent(namespace)}/${encodeURIComponent(key)}`,
      `https://abacus.jasoncameron.dev/hit/${encodeURIComponent(namespace)}/${encodeURIComponent(key)}`
    ];

    (async () => {
      for (const url of endpoints) {
        try {
          const ctrl = new AbortController();
          const t = setTimeout(() => ctrl.abort(), 4000); // timeout 4s
          const r = await fetch(url, { cache: 'no-store', signal: ctrl.signal });
          clearTimeout(t);
          if (!r.ok) throw new Error(`${r.status} ${r.statusText}`);
          const d = await r.json();
          if (d && Number.isFinite(d.value)) {
            el.textContent = Number(d.value).toLocaleString(locale);
            return;
          }
        } catch (e) {
          // try next endpoint
        }
      }
      el.textContent = '—';
    })();
  });
  </script>
</body>
</html>




